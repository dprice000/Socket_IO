<hmtl lang="en" >
        <head>
            <link rel="stylesheet" href="https://cdn.metroui.org.ua/v4/css/metro-all.min.css">
            <link rel="stylesheet" href="index.css">
        </head>
        <body>
            <div ng-view>
                <div id="tile-container" ng-app="project" ng-controller="myCtrl">
                    <div ng-repeat="temp in temps" data-role="tile" data-size="medium" class="bg-green temp-tile"><span class="badge-top">{{temp.name}}</span><h1 class="pos-absolute pos-center">{{temp.value}}&#8451;</h1></div>
                </div>
            </div>

            <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
            <script src="/socket.io/socket.io.js"></script>    
            <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
            <script src="https://cdn.metroui.org.ua/v4/js/metro.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.10/angular.min.js"></script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.10/angular-resource.min.js">
            </script>
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.10/angular-route.min.js">
            </script>
            <script>  

                var app = angular.module("project", []);

                app.factory('socket', function ($rootScope) {
                    var socket = io.connect('http://localhost:4200');
                    return {
                        on: function (eventName, callback) {
                        socket.on(eventName, function () {  
                            var args = arguments;
                            $rootScope.$apply(function () {
                            callback.apply(socket, args);
                            });
                        });
                        },
                        emit: function (eventName, data, callback) {
                        socket.emit(eventName, data, function () {
                            var args = arguments;
                            $rootScope.$apply(function () {
                            if (callback) {
                                callback.apply(socket, args);
                            }
                            });
                        })
                        }
                    };
                    });

                app.controller('myCtrl', function ($scope, socket) {
                    $scope.temps = [
                        { 'name': 'Pipe1', 'value': 30 },
                        { 'name': 'Pipe2', 'value': 22 },
                        { 'name': 'Pipe3', 'value': 25 },
                        { 'name': 'Pipe4', 'value': 32 }
                    ];

                    socket.on('readouts', function(data) {
                        // Parses new JSON and updates ViewModel temps property.
                        console.log(data);
                        $scope.temps = JSON.parse(data);
                    });
                });

            </script>        
        </body>
</hmtl> 